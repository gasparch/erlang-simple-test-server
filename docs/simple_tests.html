<html>
	<head>
		<title>Simple testing environment in Erlang</title>
	<style>
		body { width: 500px; 
			margin-left: 70px; 
			margin-top: 40px;
			text-align: justify; }
		.old_news {
			font-size: xx-small;
		}
	</style>
	</head>
	<body>

		<h1>Erlang Testing Server compatible simple testing module</h1>

		<p>Erlang Testing Server is too heavy to setup in small projects like ours. So I've stripped down 
		functionality of testing suite to keep it as simple as possible. It provides almost the same 
		interface as testing server, so you can put your test files into ETS later. </p>


		<h3>Download simple testing files</h3>
		<p>Source files: 
		<ul>
			<li><a href="simple_tests.erl">simple_tests.erl</a></li>
			<li><a href="test_server.hrl">test_server.hrl</a></li>
		</ul>
		</p>


		<h3>Example</h3>
		<p>Now simple example how it should be run

		<blockquote>
			erl -noshell -s simple_tests run <i>name_of_SUITE</i> -s init stop
		</blockquote>

		<b>name_of_SUITE</b> is a name of module which implements specific test suite.

		Testing suite module must implement following functions

<pre>
-module(testing_SUITE).
-compile(export_all).
-include("test_server.hrl").

all(doc) -&gt; "test agent/terminal addition";
all(suite) -&gt;
[
	test_login
].


test_login(doc) -&gt; "performing login"; % textual description of test
test_login(Config) -&gt;
	?line call_nigga(clean_db, ""),	% doing some calls
	?line Ticket = login(),
	?put(ticket, Ticket). % storing some values between runs
</pre>


		<ul>
			<li>
			all(doc) should return name of suite running
			</li>
			<li>
			all(suite) runs one time before starting all tests. It can be used to setup initial environment. 
			It should return list of test cases (function names) which should be run by this suite.
			</li>

			<li>test_login(doc) returns printable name of test</li>
			<li>test_login(Config) runs test. In Config variable initialization values for the test are provided (see below for init_per_testcase and fin_per_testcase functions). 
			<br>
			?line macros is used to keep track on which line it was called last time -- so if you prepend each of your lines with this macros, you can see line number on test faulure.<br>
			<br>
			<h5>Functions below do not exist in ETS, so do not use them if you want to move test later to ETS</h5>
			<b>?put(key, Value)</b> macros may be used to store values between test case runs (one test case can initialize and prepare environment and another test case will run using previous test case's data).<br>
			<br>
			<b>?get(key)</b> retrieves value from storage server.<br>
			<br>
			<b>match(Value, SecondValue)</b> function should be used for matching two values together -- you will see both correct and illegal values in crash dump.<br>
			<br>
			<b>defined(Name, Value)</b> will crash if Value equals to undefined.
			</li>
		</ul>

		Before each test case run init_per_testcase/2 function is called if it's present in the suite module.<br>
			<br>
		<b>init_per_testcase(Case, _)</b> should do initialization work before each test case and return proplist with configuration data which will be passed to test case. Case -- is an atom with test case name, second argument is not used, and remaned there for bckward compatibility with ETS. <br>
			<br>
		<b>fin_per_testcase(Case, Config)</b> is used for per test case cleanup and called after test case finished (successful or not). Config is the case config which was generated by previous function.<br>
		<br>
		<br>
		Test should fail in two cases -- when it runs too long (longer than ?TIMEOUT) or if it fails on matching or does not finish successfully at all. In case if test case returns some value, this value is ignored and test is considered as passed.
		</p>

		<p>
		You can reach me by email -- Gaspar Chilingarov &lt;nm@web.am&gt;
		</p>

		<div style='position: fixed; width: 400px; height: auto; bottom: 0px; right: 0px; margin-left: auto; margin-right: auto;'>Hosted by <a href="http://zanazan.am/">zanazan.am</a> 
		</div>

	</body>
</html>
